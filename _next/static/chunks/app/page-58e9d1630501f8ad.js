(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7562:function(e,t,n){Promise.resolve().then(n.t.bind(n,2359,23)),Promise.resolve().then(n.t.bind(n,8173,23)),Promise.resolve().then(n.t.bind(n,231,23)),Promise.resolve().then(n.bind(n,912)),Promise.resolve().then(n.bind(n,1481)),Promise.resolve().then(n.t.bind(n,4553,23)),Promise.resolve().then(n.bind(n,1799))},7120:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var a=n(7437),i=n(8059),r=n.n(i);let o={close:e=>{let{className:t="",fill:n="#999999",width:i=24,height:o=24,viewBox:l="0 0 24 24",hoverFill:s="",size:c=24}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{width:i*c/24,height:(o||i)*c/24,viewBox:l,xmlns:"http://www.w3.org/2000/svg",className:r().dynamic([["3786e5510860affb",[s]]])+" "+(t||""),children:(0,a.jsx)("path",{d:"M12 10.5867L16.95 5.63672L18.364 7.05072L13.414 12.0007L18.364 16.9507L16.95 18.3647L12 13.4147L7.04999 18.3647L5.63599 16.9507L10.586 12.0007L5.63599 7.05072L7.04999 5.63672L12 10.5867Z",fill:n,className:r().dynamic([["3786e5510860affb",[s]]])})}),(0,a.jsx)(r(),{id:"3786e5510860affb",dynamic:[s],children:"svg.__jsx-style-dynamic-selector:hover path.__jsx-style-dynamic-selector{fill:".concat(s,"}")})]})},upload:e=>{let{className:t="",stroke:n="#999999",width:i=24,height:r=24,viewBox:o="0 0 24 24",size:l=24}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("svg",{width:i*l/24,height:(r||i)*l/24,viewBox:o,xmlns:"http://www.w3.org/2000/svg",className:t,children:[(0,a.jsx)("path",{d:"M21.25 13V8.5C21.25 7.17392 20.7232 5.90215 19.7855 4.96447C18.8479 4.02678 17.5761 3.5 16.25 3.5H7.75C6.42392 3.5 5.15215 4.02678 4.21447 4.96447C3.27678 5.90215 2.75 7.17392 2.75 8.5V15.5C2.75 16.1566 2.87933 16.8068 3.1306 17.4134C3.38188 18.02 3.75017 18.5712 4.21447 19.0355C5.15215 19.9732 6.42392 20.5 7.75 20.5H14.01",stroke:n,fill:"transparent",strokeWidth:"1.5",strokeMiterlimit:"10",strokeLinecap:"round"}),(0,a.jsx)("path",{d:"M3.00781 17.0016L5.74781 13.8016C6.10765 13.4442 6.57992 13.2221 7.08469 13.1729C7.58946 13.1237 8.09573 13.2504 8.51781 13.5316C8.9399 13.8128 9.44616 13.9395 9.95093 13.8903C10.4557 13.8411 10.928 13.619 11.2878 13.2616L13.6178 10.9316C14.2873 10.2598 15.1737 9.8478 16.1188 9.76904C17.064 9.69028 18.0064 9.9499 18.7778 10.5016L21.2478 12.4116M8.00781 10.1716C8.22581 10.1703 8.44141 10.126 8.64231 10.0414C8.8432 9.95677 9.02546 9.83339 9.17868 9.67832C9.3319 9.52325 9.45307 9.33951 9.53528 9.13761C9.61749 8.93571 9.65913 8.71959 9.65781 8.50159C9.6565 8.2836 9.61226 8.068 9.52763 7.8671C9.44299 7.6662 9.31961 7.48394 9.16454 7.33072C9.00946 7.17751 8.82573 7.05634 8.62383 6.97413C8.42192 6.89192 8.20581 6.85028 7.98781 6.85159C7.54755 6.85424 7.12638 7.03168 6.81694 7.34487C6.50751 7.65805 6.33516 8.08133 6.33781 8.52159C6.34046 8.96185 6.5179 9.38303 6.83109 9.69246C7.14427 10.0019 7.56755 10.1742 8.00781 10.1716Z",stroke:n,fill:"transparent",strokeWidth:"1.5",strokeMiterlimit:"10",strokeLinecap:"round"}),(0,a.jsx)("path",{d:"M18.7031 15V20",stroke:n,fill:"transparent",strokeWidth:"1.5",strokeMiterlimit:"10",strokeLinecap:"round"}),(0,a.jsx)("path",{d:"M21.0001 17.1033L19.0331 15.1363C18.9905 15.0931 18.9397 15.0588 18.8837 15.0354C18.8278 15.012 18.7677 15 18.7071 15C18.6464 15 18.5864 15.012 18.5304 15.0354C18.4744 15.0588 18.4237 15.0931 18.3811 15.1363L16.4141 17.1033",stroke:n,fill:"transparent",strokeWidth:"1.5",strokeMiterlimit:"10",strokeLinecap:"round"})]})})}};var l=e=>{let{name:t,size:n=24,fill:i="#999",...r}=e,l=o[t];return l?(0,a.jsx)(l,{size:n,fill:i,...r}):(0,a.jsx)(a.Fragment,{})}},1799:function(e,t,n){"use strict";n.r(t);var a=n(7437),i=n(4839),r=n(6648),o=n(6463),l=n(2265),s=n(6115),c=n(9076),d=n(7646),u=n(7120),h=n(6400),m=n.n(h),p=n(357);t.default=e=>{let{frontLayer:t,backLayer:n,demoAvatar:h=[],yOffset:v,defaultImage:f="/images/avatar.webp",stepElement:g,fontFamily:w,useRemoveBackground:x=!0}=e,y=(0,o.useSearchParams)(),j=(0,o.useRouter)(),C=(0,o.usePathname)(),_=(0,l.createRef)(),b=(0,l.useRef)(null),[L,k]=(0,l.useState)(""),[N,P]=(0,l.useState)(""),[M,T]=(0,l.useState)(0),[A,E]=(0,l.useState)(""),[R,B]=(0,l.useState)(!1),I=(0,l.useMemo)(()=>(0,c._)(),[]),U=async(e,t)=>{try{T(e=>e+1);let n=new FormData;n.append("image",e),t&&n.append("token",t);let a="".concat(p.env.NEXT_PUBLIC_API||"/api","/remove-background"),i=await fetch(a,{method:"POST",body:n});return await i.json()}catch(e){return console.log(e),{}}finally{setTimeout(()=>{T(e=>e-1)},1e3)}},S=async e=>{try{T(e=>e+1);let t=new FileReader;t.onload=function(){let n=new window.Image;n.onload=function(){let a=document.createElement("canvas"),i=n.width,r=n.height;if(i<2560&&r<2560){t.result&&k(t.result);return}i>r?i>2560&&(r=Math.round(2560*r/i),i=2560):r>2560&&(i=Math.round(2560*i/r),r=2560),a.width=i,a.height=r;let o=a.getContext("2d");null==o||o.drawImage(n,0,0,i,r);let l=a.toDataURL(e.type);k(l)},n.src=t.result},t.readAsDataURL(e)}catch(e){console.log(e)}finally{setTimeout(()=>{T(e=>e-1)},1e3)}},F=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams(y);Object.keys(e).forEach(n=>{e[n]?t.set(n,e[n]):t.delete(n)});let n=t.toString(),a=n?"".concat(C,"?").concat(n):C;j.push(a,{scroll:!1})},H=async e=>{try{e.preventDefault();let t=null;if(e.target&&(t=e.target.files),!t||t.length<1)return;if(!t[0].type.match(/(^image)(\/)[a-zA-Z0-9_]*/gi)){alert("Vui l\xf2ng chọn định dạng ảnh");return}if(t[0].size/1024/1024>10){alert("Vui l\xf2ng sử dụng file ảnh nhỏ hơn 10MB");return}if(!x){S(t[0]),e.target.value="";return}window.grecaptcha.enterprise.ready(async()=>{let n=await window.grecaptcha.enterprise.execute("6LdB4PYpAAAAAJd1Tmi5sZXiisfl5tfr_itrYf3B",{action:"REMOVE_BACKGROUND_API"}),a=await U(t[0],n);(null==a?void 0:a.url)?(k("".concat(p.env.NEXT_PUBLIC_API||"/api").concat(a.url)),F({image:a.url.slice(1)})):S(t[0]),e.target.value=""})}catch(e){console.log(e)}},O=async()=>{try{var e,a;let i=document.createElement("canvas");i.width=1280,i.height=1280;let r=i.getContext("2d");if(void 0===(null===(e=_.current)||void 0===e?void 0:e.cropper)||!r)return;let o=null===(a=_.current)||void 0===a?void 0:a.cropper.getCroppedCanvas().toDataURL(),l=[n,o,t].filter(e=>!!e),s=Array.from(Array(l.length)).map(()=>new window.Image),c=s.map(e=>new Promise(t=>e.onload=()=>t(e)));Promise.all(c).then(async e=>{for await(let t of(N&&await (0,d.HM)({ctx:r,inputText:N,yOffset:v,fontFamily:w}),e))(0,d.TR)(r,t);N&&await (0,d.HM)({ctx:r,inputText:N,yOffset:v,fontFamily:w});let t=i.toDataURL("image/jpeg");if(I)B(!0),E(t);else{let e=document.createElement("a");e.href=t,e.download="".concat(N.toUpperCase(),".jpg"),document.body.appendChild(e),e.click(),document.body.removeChild(e)}}),s.forEach((e,t)=>e.src=l[t])}catch(e){console.log(e)}};return(0,l.useEffect)(()=>{let e=document.body;return R?e.style.overflow="hidden":e.style.overflow="",()=>{e.style.overflow=""}},[R]),(0,l.useEffect)(()=>{let e=y.get("image");e?(async()=>{T(e=>e+1);let t="".concat(p.env.NEXT_PUBLIC_API||"/api","/").concat(e),n=new window.Image;n.onload=()=>{k("".concat(p.env.NEXT_PUBLIC_API||"/api","/").concat(e)),T(e=>e-1)},n.onerror=()=>{k(f),T(e=>e-1)},n.src=t})():k(f);let t=y.get("name");if(t){var n;P(t);let e=null===(n=b.current)||void 0===n?void 0:n.getContext("2d");if(!e)return;e.clearRect(0,0,1280,1280),t&&(0,d.HM)({ctx:e,inputText:t,yOffset:v,fontFamily:w})}},[]),(0,l.useEffect)(()=>{let e=()=>{var e,t;null===(t=window)||void 0===t||null===(e=t.location)||void 0===e||e.reload()};return window.addEventListener("orientationchange",e),()=>{window.removeEventListener("orientationchange",e)}},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:m().wrapper,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(s.Z,{ref:_,style:{height:320,width:"100%"},aspectRatio:1,dragMode:"move",preview:".img-preview",src:L,minCropBoxHeight:10,minCropBoxWidth:10,background:!0,responsive:!0,rotatable:!0,autoCropArea:1,checkOrientation:!1,guides:!0}),M>0&&(0,a.jsx)("div",{className:m().loading,children:(0,a.jsx)("div",{})}),(0,a.jsxs)("button",{className:m().btn_upload,children:[(0,a.jsx)("input",{type:"file",accept:"image/*","aria-label":"Tải ảnh l\xean",onChange:H}),(0,a.jsx)(u.Z,{name:"upload",stroke:"current"}),(0,a.jsx)("span",{children:"Tải ảnh l\xean"})]}),(0,a.jsxs)("label",{className:m().name,htmlFor:"name",children:[(0,a.jsx)("p",{children:"T\xean Của Bạn"}),(0,a.jsx)("input",{type:"text",id:"name",name:"name",value:N,placeholder:"Nhập t\xean của bạn",onChange:e=>{var t;let n=e.currentTarget.value;P(n),F({name:n.trim()});let a=null===(t=b.current)||void 0===t?void 0:t.getContext("2d");a&&(a.clearRect(0,0,1280,1280),n&&(0,d.HM)({ctx:a,inputText:n,yOffset:v,fontFamily:w}))}})]}),(0,a.jsxs)("div",{className:m().guide,children:[(0,a.jsx)("p",{className:m().title,children:"Hướng dẫn"}),g]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:m().image_preview,children:(0,a.jsxs)("div",{className:m().image_preview_container,children:[n&&(0,a.jsx)(r.default,{src:n,className:m().bottom_layer,fill:!0,alt:"avatar-bottom-layer",priority:!0,unoptimized:!0}),(0,a.jsx)("div",{className:"img-preview"}),t&&(0,a.jsx)(r.default,{src:t,className:m().top_layer,fill:!0,alt:"avatar-top-layer",priority:!0,unoptimized:!0}),(0,a.jsx)("canvas",{ref:b,width:1280,height:1280})]})}),(0,a.jsx)("button",{className:m().btn_download,onClick:O,children:(0,a.jsx)("span",{children:"Download"})})]}),(0,a.jsx)("div",{className:m().example,children:(0,a.jsx)("div",{children:h.length>0&&h.map(e=>(0,a.jsx)("div",{children:(0,a.jsx)(r.default,{src:e,alt:e,fill:!0,style:{objectFit:"cover"},unoptimized:!0})},e))})})]}),I&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:(0,i.Z)(m().modal,R&&m().opened),onClick:()=>B(!1),children:(0,a.jsx)("div",{className:(0,i.Z)(m().container,R&&m().opened),onClick:e=>e.stopPropagation(),children:(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:m().body,children:[A&&(0,a.jsx)("div",{className:m().image,children:(0,a.jsx)("div",{children:(0,a.jsx)(r.default,{src:A,fill:!0,alt:"ANH TRAI ".concat(N.toUpperCase()),style:{objectFit:"cover"},unoptimized:!0})})}),(0,a.jsx)("p",{children:"Ấn v\xe0o ảnh, giữ 3s rồi lưu ảnh về m\xe1y v\xe0 flex ngay tr\xean trang c\xe1 nh\xe2n n\xe0o!"}),(0,a.jsx)("button",{className:m().btn_download,onClick:()=>B(!1),children:(0,a.jsx)("span",{children:"Đ\xf3ng"})})]})})})})})]})}},7646:function(e,t,n){"use strict";n.d(t,{HM:function(){return r},TR:function(){return a},Tx:function(){return i}});let a=async(e,t)=>{let n=e.canvas.width,a=e.canvas.height,i=t.width,r=t.height,o=Math.min(n/i,a/r),l=i*o,s=r*o,c,d,u,h,m=1;l<n&&(m=n/l),1e-14>Math.abs(m-1)&&s<a&&(m=a/s),l*=m,s*=m,u=i/(l/n),h=r/(s/a),(c=(i-u)*.5)<0&&(c=0),(d=(r-h)*.5)<0&&(d=0),u>i&&(u=i),h>r&&(h=r),await e.drawImage(t,c,d,u,h,0,0,n,a)},i=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e.font="300 130px Jaapokki",e.fillStyle="#fff",e.save(),e.translate(43,1110),e.shadowColor="rgba(0, 0, 0, 0.5)",e.shadowBlur=10,e.shadowOffsetX=-5,e.shadowOffsetY=0,await e.fillText(t.trim().toUpperCase(),5,0),e.restore()},r=async e=>{let{ctx:t,inputText:n="",maxWidth:a=1280,yOffset:i=800,fontFamily:r="Jaapokki"}=e,o=n.trim().toUpperCase(),l=0;try{let e=70;for(t.font="300 ".concat(e,"px ").concat(r),t.fillStyle="#fff",t.save(),l=t.measureText(o).width;l>a-20&&e>60;)e-=5,t.font="300 ".concat(e,"px ").concat(r),t.fillStyle="#fff",t.save(),l=t.measureText(o).width}catch(e){t.font="300 140px ${fontFamily}",t.fillStyle="#fff",t.save(),l=t.measureText(o).width}let s=(a-l)/2;t.translate(s,i),t.shadowColor="rgba(252, 118, 81, 0.5)",t.shadowBlur=10,t.shadowOffsetX=-5,t.shadowOffsetY=0,await t.fillText(o,0,0),t.restore()}},9076:function(e,t,n){"use strict";n.d(t,{_:function(){return a}});let a=()=>{try{var e,t,n,a,i,r;if(!(null===(e=navigator)||void 0===e?void 0:e.userAgent)&&!(null===(t=navigator)||void 0===t?void 0:t.vendor)&&!(null===(n=window)||void 0===n?void 0:n.opera))return!1;return/(iPhone|iPad)/i.test((null===(a=navigator)||void 0===a?void 0:a.userAgent)||(null===(i=navigator)||void 0===i?void 0:i.vendor)||(null===(r=window)||void 0===r?void 0:r.opera))}catch(e){return console.log(e),!1}}},4553:function(e){e.exports={main:"Ql9LZK",section:"QAFieq"}},6400:function(e){e.exports={wrapper:"pX5Ldl",loading:"WVo3x0",spin:"a2Eypc",btn_group:"Gpouo5",btn_rotate:"vH_Uei",btn_upload:"NrgLBy",btn_download:"hFSqKL",name:"DhwSuN",guide:"IdtGme",title:"QmmN62",image_preview:"o5mlLY",image_preview_container:"Mj_Biu",bottom_layer:"MArVH9",top_layer:"X4j_2y",example:"crYRzU",modal:"zVkhgv",opened:"cwoYbJ",container:"_5tOENA",body:"__PG1n",image:"VVveDL"}}},function(e){e.O(0,[315,247,231,971,23,744],function(){return e(e.s=7562)}),_N_E=e.O()}]);